function t(t,e){var r,s,n,o;let u,c;if(S.store(t))c=t;else if('function'==typeof t)u=t;else{if('object'!=typeof t||null===t)throw Error('shape should be a store or object with stores');c=y(t)}const a=null!==(r=null===(s=c)||void 0===s?void 0:s.shortName)&&void 0!==r?r:'Unknown',i=g(a+".View mounted"),p=g(a+".View unmounted");return o=n=class extends l{constructor(...e){super(...e),this._unsubscribe=null,this._hasUnmounted=0,this.store='function'==typeof t?u(this.props):c,this.state={currentState:this.store.getState()}}componentDidMount(){i({props:this.props,state:this.store.getState()}),this.subscribe()}componentWillUnmount(){p({props:this.props,state:this.store.getState()}),this.unsubscribe(),this._hasUnmounted=1}render(){return e(this.props,this.state.currentState)}subscribe(){this._unsubscribe=this.store.watch(t=>{this._hasUnmounted||this.setState(e=>t===e.currentState?null:{currentState:t})})}unsubscribe(){'function'==typeof this._unsubscribe&&this._unsubscribe(),this._unsubscribe=null}},n.displayName=a+".View",n.mounted=i,n.unmounted=p,o}function e(e){return t(e,({children:t},e)=>t(e))}function r(t){var e,r;return r=e=class extends l{constructor(...t){super(...t),this.state={currentValue:null}}static getDerivedStateFromProps(e){return t.setState(e.value),{currentValue:e.value}}render(){return this.props.children}},e.displayName=t.shortName+".Provider",e.defaultProps={children:null},r}function s(t,r,s){var n,o;const u=e(t);return o=n=class extends l{constructor(...t){super(...t),this.renderProp=t=>s(this.props,t,this.context)}render(){return h(u,null,this.renderProp)}},n.contextType=r,o}function n(t){if(!S.store(t))throw Error('expect useStore argument to be a store');const e=d(P,void 0,t.getState)[1];return U(()=>t.watch(e),[t]),t.getState()}function o({store:t,keys:e,fn:r}){if(!S.store(t))throw Error('useStoreMap expects a store');if(!Array.isArray(e))throw Error('useStoreMap expects an array as keys');if('function'!=typeof r)throw Error('useStoreMap expects a function');const s=f(()=>v(r(t.getState(),e)).on(t,(t,s)=>r(s,e)),e),o=n(s);return U(()=>()=>{s.off(t),x(s,{deep:1})},e),o}function u(){return(u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t}).apply(this,arguments)}function c(t,r){const s=e(t),n=t=>h(s,null,e=>h(r,u({},t,e)));return n.displayName="Connect("+(r.displayName||r.name||'Unknown')+")",n}function a(t){return e=>c(e,t)}function i(t,e={}){w(()=>(t.open(),()=>t.close()),[t]),t.set(e)}function p(t="gate",e={}){const r=E(0),s=E(e),{set:n}=N(s,{set:(t,e)=>e}),{open:o,close:u,destructor:c}=N(r,{open:()=>a.predicate()&&1,close:()=>0,destructor:()=>0});class a extends b{static childGate(e="Subgate"){const r=p(t+"/"+e);r.predicate=()=>a.status.getState();let s=0,n=0;return r.open.watch(()=>{n||(s=1)}),r.close.watch(()=>{n||(s=0)}),a.status.watch(t=>{n=1,s&&t&&!r.status.getState()&&r.open(),n=0}),a.close.watch(()=>{n=1,r.close(),n=0}),a.destructor.watch(()=>r.destructor()),r}componentDidMount(){a.open()}componentWillUnmount(){a.close()}render(){return a.set(this.props),null}}a.predicate=()=>1,a.displayName="Gate:"+t,a.isOpen=0,a.current=s.getState(),a.open=o,a.close=u,a.status=r,a.state=s,a.set=n,a.destructor=c,a.isTerminated=0;const i=r.watch(t=>a.isOpen=t),l=s.watch(t=>a.current=t);r.map(t=>{t||(a.current=e)}),s.reset(u);const h=c.watch(()=>{a.isTerminated=1}),d=c.watch(()=>{d(),i(),l(),h(),a.status.off(a.open),a.status.off(a.close),a.status.off(a.destructor),a.state.off(a.set)});return a}import{Component as l,createElement as h,useReducer as d,useMemo as f,useLayoutEffect as m,useEffect as w,PureComponent as b}from'react';import{is as S,createStoreObject as y,createEvent as g,createStore as v,clearNode as x,createDomain as _,createApi as N}from'effector';const U='undefined'!=typeof window?m:w,P=(t,e)=>e,{store:E}=_('Gate');export{a as connect,t as createComponent,s as createContextComponent,p as createGate,c as createReactState,e as createStoreConsumer,r as unstable_createStoreProvider,i as useGate,n as useStore,o as useStoreMap};
//# sourceMappingURL=effector-react.es.js.map
